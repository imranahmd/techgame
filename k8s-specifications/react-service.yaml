apiVersion: v1
kind: Service
metadata: 
  name: frontend
  namespace: three-tier
spec:
  ports:
  - port: 3000
    protocol: TCP
  type: ClusterIP
  selector:
    role: frontend



    =======================

    apiVersion: v1
kind: Service
metadata:
  name: frontend-service
  namespace: production
  labels:
    app: frontend
  annotations:
    service.beta.kubernetes.io/aws-load-balancer-type: "nlb"  # Use AWS Network Load Balancer
    service.beta.kubernetes.io/aws-load-balancer-scheme: "internet-facing"
spec:
  type: LoadBalancer
  selector:
    app: frontend
  ports:
    - protocol: TCP
      port: 80
      targetPort: 80

      ==============================


      Detailed Explanation

Weâ€™ll break it down section by section ğŸ‘‡

ğŸ·ï¸ Metadata Section
metadata:
  name: frontend-service
  namespace: production
  labels:
    app: frontend


name: Identifies your service in the cluster (frontend-service).

namespace: Tells Kubernetes this service belongs to your production environment (same as the frontend deployment).

labels: Key-value pair for organization; helps identify and link this service with your pods.

ğŸ’¡ Kubernetes best practice: use matching namespaces for backend, frontend, and db (like production) to keep things isolated and manageable.

ğŸ§© Annotations (AWS-Specific Magic)
annotations:
  service.beta.kubernetes.io/aws-load-balancer-type: "nlb"
  service.beta.kubernetes.io/aws-load-balancer-scheme: "internet-facing"


These are AWS EKS annotations that tell Kubernetes how to configure the Load Balancer in AWS.

Annotation	Description
aws-load-balancer-type: "nlb"	Creates a Network Load Balancer (NLB) instead of a Classic Load Balancer.
âœ… Ideal for production: low latency, high throughput, static IP support.
aws-load-balancer-scheme: "internet-facing"	Makes the NLB public â€” accessible from the internet.
For internal-only apps (e.g., internal dashboards), use "internal".

âš¡ AWS creates this Load Balancer automatically when you apply the YAML.
Youâ€™ll see it appear in your AWS EC2 â†’ Load Balancers dashboard.

âš™ï¸ Spec Section
spec:
  type: LoadBalancer


type: LoadBalancer â€” This is key.
It tells Kubernetes:

â€œCreate an external AWS Load Balancer and connect it to my service.â€

When this is deployed:

EKS automatically provisions an NLB in your AWS account.

Assigns a public DNS name (like a1b2c3d4e5f6.elb.amazonaws.com).

Forwards requests from that Load Balancer to your frontend pods.

ğŸ”— You can use this DNS directly or map it to a custom domain (e.g. app.mycompany.com) via Route 53.

ğŸ¯ Selector
selector:
  app: frontend


Connects the Service to the Pods created by your frontend-deployment.yaml.

The selector matches labels (app: frontend).

This means: â€œSend traffic from the Load Balancer to all pods labeled app=frontend.â€

ğŸŒ Ports Configuration
ports:
  - protocol: TCP
    port: 80
    targetPort: 80

Field	Description
protocol: TCP	HTTP traffic runs on TCP protocol.
port: 80	The external port that clients (users) will access.
targetPort: 80	The internal container port (from your deployment).
This is where Nginx in your frontend container listens.

So when a user visits:

http://<AWS-LoadBalancer-DNS>:80


â†’ Kubernetes routes that request
â†’ To your frontend pods on port 80 inside the cluster.

âš™ï¸ How It Works in AWS EKS (Step-by-Step)

You run:

kubectl apply -f frontend-service.yaml


EKS creates:

A Service object in Kubernetes.

An NLB (Network Load Balancer) in AWS automatically.

AWS assigns:

A Public DNS name (like a1b2c3d4e5f6.elb.amazonaws.com).

Connects that NLB to your worker node ENIs (Elastic Network Interfaces).

Traffic flow:

User â†’ AWS Load Balancer (port 80)
      â†’ NodePort on EKS node
      â†’ Frontend Pod (container port 80)


Kubernetes keeps everything synced automatically (if pods scale or restart).

ğŸš€ Production Enhancements (Highly Recommended)
Enhancement	Description
âœ… HTTPS/SSL	Use AWS Load Balancer Controller with ALB + ACM certificate for HTTPS.
âœ… Custom Domain	Add a DNS record in Route 53 â†’ point your domain to Load Balancer DNS.
âœ… Autoscaling	Add HorizontalPodAutoscaler (HPA) for scaling based on CPU/memory usage.
âœ… Monitoring	Use Prometheus + Grafana or CloudWatch to monitor NLB & service metrics.
âœ… Internal Access (optional)	Change "internet-facing" â†’ "internal" if you only want private VPC access.
ğŸ§© Example Output

After applying:

kubectl get svc -n production


Youâ€™ll see:

NAME                TYPE           CLUSTER-IP      EXTERNAL-IP
frontend-service    LoadBalancer   10.100.34.12    a1b2c3d4e5f6.elb.amazonaws.com


You can now open in browser:

http://a1b2c3d4e5f6.elb.amazonaws.com


ğŸ‰ Your React app is live on AWS EKS via Load Balancer!


